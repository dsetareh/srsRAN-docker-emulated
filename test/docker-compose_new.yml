networks:
  corenet:
    ipam:
      config:
      - subnet: 10.80.95.0/24
      driver: default
services:
  srsenb:
    build: .
    cap_add:
    - SYS_NICE
    command: srsenb /etc/srsran/enb.conf.fauxrf --enb.mme_addr=10.80.95.10 --enb.gtp_bind_addr=10.80.95.11
      --enb.s1c_bind_addr=10.80.95.11 --enb_files.sib_config=/etc/srsran/sib.conf
    container_name: virtual-srsenb
    ipc: shareable
    networks:
      corenet:
        ipv4_address: 10.80.95.11
    volumes:
    - ./pcaps:/pcaps
  srsepc:
    build: .
    cap_add:
    - NET_ADMIN
    - SYS_NICE
    command: stdbuf -oL srsepc /etc/srsran/epc.conf --mme.mme_bind_addr=10.80.95.10
      --spgw.gtpu_bind_addr=10.80.95.10
    container_name: virtual-srsepc
    devices:
    - /dev/net/tun
    networks:
      corenet:
        ipv4_address: 10.80.95.10
  srsue:
    build: .
    cap_add: &id001
    - NET_ADMIN
    - SYS_NICE
    command: UE_CMD_PLACEHOLDER
    container_name: virtual-srsue
    depends_on: &id002
    - srsenb
    devices: &id003
    - /dev/net/tun
    ipc: service:srsenb
version: '3.8'
x-srsue:
  build: .
  cap_add: *id001
  command: stdbuf -oL srsue /etc/srsran/ue.conf.fauxrf -f20
  depends_on: *id002
  devices: *id003
  ipc: service:srsenb
